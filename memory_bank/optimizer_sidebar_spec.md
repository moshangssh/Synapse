# 功能需求文档 (FRD): 字幕优化侧边栏 (Optimizer Sidebar)

**版本**: 1.0
**日期**: 2025-08-12
**作者**: BMad-Analyst

---

## 1. 概述

本项目旨在为字幕编辑器引入一个全新的“优化侧边栏” (Optimizer Sidebar)。该侧边栏将作为一个功能聚合中心，统一收纳所有针对字幕内容的批量处理和优化工具。

本次迭代 (v1.0) 的核心目标是实现侧边栏的基础架构，并集成第一个优化功能：“一键去口水词”。

## 2. 用户故事

**作为一名字幕编辑者**，我希望能有一个专门的工具区，可以让我快速地对所有字幕执行批量优化操作，例如一键删除无意义的口水词，从而提高我的工作效率。

## 3. 功能需求详述

### 3.1. 入口点：活动栏 (Activity Bar)

- **需求**: 在应用的活动栏 (`ActivityBar`) 中增加一个新的图标按钮。
- **图标建议**: ✨ (魔法棒) 或 🚀 (火箭)。
- **交互**:
    - 点击该图标，应用的主侧边栏将显示“优化侧边栏”内容。
    - 在技术上，点击图标会调用 `useUIStore` 的 `setActiveView('optimizer')` 方法。
    - 再次点击或点击其他活动栏图标，侧边栏会切换到对应视图或关闭，行为与现有图标（如文件浏览器、搜索）保持一致。

### 3.2. 容器：优化侧边栏 (Optimizer Sidebar)

- **需求**: 创建一个新的React组件，命名为 `OptimizerSidebar.tsx`。
- **集成**:
    - 在 `MainLayout.tsx` 的 `renderSidebar` 函数中，添加一个新的 `case` 分支。
    - 当 `activeView` 的值为 `'optimizer'` 时，渲染 `<OptimizerSidebar />` 组件。

### 3.3. 内部布局：手风琴 (Accordion)

- **需求**: `OptimizerSidebar` 组件的内部布局应采用手风琴 (Accordion) 样式，以便于未来对功能进行分类和扩展。
- **组件建议**: 可以使用 Material-UI 的 `Accordion` 组件。

### 3.4. 第一个功能模块：简易模式 (Simple Mode)

- **需求**: 在手风琴布局中，创建第一个可展开的面板。
- **面板标题**: "Simple Mode"。
- **面板内容**:
    - 包含一个按钮，用于执行“一键去口水词”功能。
    - **按钮文字**: "一键去口水词"。
    - **按钮图标建议**: 🧹 (扫帚)。

### 3.5. “一键去口水词”功能逻辑

- **触发**: 点击 "Simple Mode" 面板中的“一键去口水词”按钮。
- **核心逻辑**:
    1.  **词表定义 (已优化)**:
        - **数据源**: 口水词列表应从项目根目录下的 `filler_words.json` 文件动态加载。这便于未来进行维护和扩展。
        - **状态管理**: 建议将加载的词表存放在 `useSettingsStore` 中，以便全局访问和潜在的动态修改。
        - **初始实现**: 在v1.0中，可以在 `OptimizerSidebar` 组件首次加载时读取该JSON文件。
    2.  **执行操作**:
        - 遍历 `useDataStore` 中的所有字幕 (`subtitles`)。
        - 对每一条字幕的 `text` 属性，使用正则表达式进行全局替换，删除所有在 `FILLER_WORDS` 列表中的词。
        - 正则表达式应构建为 `new RegExp(FILLER_WORDS.join('|'), 'g')`。
    3.  **状态更新**: 调用 `useDataStore` 中对应的 `updateSubtitleText` 或批量更新方法，将修改后的字幕数据更新到全局状态中。
- **用户反馈**:
    - 操作**无需**用户二次确认，点击后立即执行。
    - **成功**: 操作完成后，应调用 `useNotifier` hook 显示一个短暂的成功提示，例如：“已成功移除所有口水词”。
    - **失败**: 如果在执行过程中发生任何错误（例如，数据处理异常），应调用 `useNotifier` hook 显示一个明确的错误提示，例如：“操作失败，请稍后重试”。

## 4. 验收标准

- [ ] 活动栏中出现了一个新的图标，点击后能正确切换到“优化侧边栏”。
- [ ] “优化侧边栏”中显示了一个名为 "Simple Mode" 的手风琴面板。
- [ ] "Simple Mode" 面板可以正常展开和折叠。
- [ ] 展开 "Simple Mode" 面板后，可以看到“一键去口水词”按钮。
- [ ] 当字幕中包含“哦”、“啊”等词时，点击按钮后，这些词被立即删除。
- [ ] 当字幕中不包含口水词时，点击按钮后，字幕内容不发生任何变化。
- [ ] 操作成功后，界面右上角弹出绿色的成功通知。
- [ ] (负向测试) 如果在移除过程中出现逻辑错误，界面应弹出红色的失败通知。
